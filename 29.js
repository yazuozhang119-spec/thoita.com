let canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");const tileSize=50,menu=document.querySelector(".menu"),fullscreen={ratio:9/16,zoom:1200};let renderScale=1;function resize(){const e=window.devicePixelRatio;if(canvas.style.width=Math.ceil(window.innerWidth)+"px",canvas.style.height=Math.ceil(window.innerHeight)+"px",canvas.width=Math.ceil(window.innerWidth)*e,canvas.height=Math.ceil(window.innerHeight)*e,canvas.zoom=Math.max(.1,Math.round(Math.max(canvas.height,canvas.width*fullscreen.ratio)/fullscreen.zoom*renderScale*100)/100),canvas.w=canvas.width/canvas.zoom,canvas.h=canvas.height/canvas.zoom,ctx.scale(canvas.zoom,canvas.zoom),ctx.lineJoin="round",ctx.lineCap="round",menu.style.width=Math.ceil(window.innerWidth)/canvas.zoom*e/1.65+"px",menu.style.height=Math.ceil(window.innerHeight)/canvas.zoom*e/1.65+"px",menu.style.transform=`scale(${canvas.zoom/e*1.65})`,menu.style.transformOrigin="0px 0px","account"===window.state){const n=document.querySelector(".login-menu");n.style.width=Math.ceil(window.innerWidth)/canvas.zoom*e/1.65+"px",n.style.height=Math.ceil(window.innerHeight)/canvas.zoom*e/1.65+"px",n.style.transform=`scale(${canvas.zoom/e*1.65})`,n.style.transformOrigin="0px 0px"}try{menuInventory&&menuInventory.positionPetalSlots()}catch(e){}try{inventory&&inventory.positionPetalSlots()}catch(e){}"undefined"!=typeof levelBar&&levelBar.calculateDimensions(),"undefined"!=typeof biomeManager&&biomeManager.updateArrowDimensions(),void 0!==globalInventory&&globalInventory.resizeScroll(),!0===window.is3D&&window.resize3D()}window.addEventListener("resize",function(){resize()});const menuEnemyIncrementRadii=[3.6,4.8,6.6,7.2,8,12,18];let menuPlayer1,menuPlayer2,menuPlayersInitialized=!1,lastTime=performance.now();dt=0;let time=performance.now();function render(){requestAnimationFrame(render),draw(),window.flowrMod&&window.flowrMod.rarities&&(window.flowrMod.rarities=Colors.rarities)}function draw(){if(time=performance.now(),dt=time-lastTime,lastTime=time,dt>1e3&&(dt=0),"account"===window.state?renderAccountMenu(dt):"menu"===window.state?renderMenu(dt):(renderGame(dt),"disconnected"===window.state&&null==window.connectOtherServerId&&renderDisconnectedText(dt)),!0===window.toRenderDebug){if(window.framesRendered++,window.framesRendered>10){const e=performance.now();window.fps=Math.floor(window.framesRendered/(e-window.lastFramesRenderedResetTime)*1e3),window.lastFramesRenderedResetTime=e,window.framesRendered=0}renderDebug()}}window.fps=0,window.interpolateCalls=0,window.framesRendered=0,window.lastFramesRenderedResetTime=performance.now(),window.clicks=0,window.clickLoc={},window.activeClicks=[];const originalDraw=draw;window.draw=function(){window.Perf?(window.Perf.mark("draw"),originalDraw(),window.Perf.end("draw")):originalDraw()};const globalInventory=new GlobalInventory,specialGlobalInventory=new SpecialGlobalInventory;window.specialGlobalInventory=specialGlobalInventory;let maxRarityObtained=0;const menuInventory=new Inventory(savedSlotAmount);menuInventory.initChangePetalsQueue();let squadUI=new SquadUI;const craftingMenu=new CraftingMenu;let connectingTextAnimationCompletion=1,particles=[];function renderMenu(e){const{ratio:n,last:a,current:t,direction:r}=biomeManager.getCurrentBiomeData();if(1!==n){"right"===r?(ctx.fillStyle=Colors.biomes[a].background,ctx.strokeStyle=Colors.biomes[a].grid):(ctx.fillStyle=Colors.biomes[t].background,ctx.strokeStyle=Colors.biomes[t].grid),renderBg(),ctx.save(),ctx.beginPath(),"right"===r?ctx.rect(0,0,smoothstep(smoothstep(n))*canvas.w,canvas.h):ctx.rect(0,0,(1-smoothstep(smoothstep(n)))*canvas.w,canvas.h),ctx.clip(),ctx.closePath(),"right"===r?(ctx.fillStyle=Colors.biomes[t].background,ctx.strokeStyle=Colors.biomes[t].grid):(ctx.fillStyle=Colors.biomes[a].background,ctx.strokeStyle=Colors.biomes[a].grid),renderBg(),ctx.restore();for(let e=0;e<menuEnemies.length;e++)if(void 0!==menuEnemies[e].updatedBiome&&("right"===r&&menuEnemies[e].render.x<=smoothstep(smoothstep(n))*canvas.w||"left"===r&&menuEnemies[e].render.x>=(1-smoothstep(smoothstep(n)))*canvas.w)){delete menuEnemies[e].updatedBiome;const n=biomeEnemyMap[t]??[];menuEnemies[e].type=n[Math.floor(Math.random()*n.length)],menuEnemies[e]=new Enemy(menuEnemies[e])}}else ctx.fillStyle=Colors.biomes[t].background,ctx.strokeStyle=Colors.biomes[t].grid,renderBg();biomeManager.draw(),!menuPlayersInitialized&&canvas.w>0&&canvas.h>0&&(initMenuPlayers(),menuPlayersInitialized=!0),menuPlayersInitialized&&menuPlayer1&&menuPlayer2&&(updateMenuPlayers(e),renderMenuPlayers()),renderMenuEnemies(),settingsMenu.draw(),(!1===window.connected||time-window.connectedTime<800)&&(connectingTextAnimationCompletion=!1===window.connected?1:1-easeOutCubic((time-window.connectedTime)/800),ctx.globalAlpha=1,ctx.font="900 42px 'Ubuntu'",ctx.fillStyle="#f0f0f0",ctx.strokeStyle="black",ctx.lineWidth=5,ctx.textAlign="center",ctx.textBaseline="middle",ctx.strokeText("Connecting...",canvas.w/2,.5*canvas.h*connectingTextAnimationCompletion-.03*canvas.h),ctx.fillText("Connecting...",canvas.w/2,.5*canvas.h*connectingTextAnimationCompletion-.03*canvas.h));let i=!1;if(time-window.connectedTime<1e3){i=!0;const e=easeOutCubic(smoothstep((time-window.connectedTime)/1e3));var o=0*e+(1-e)*(-canvas.h/2-140);ctx.translate(0,o)}ctx.font="900 91px Ubuntu",ctx.textAlign="center",ctx.textBaseline="middle",ctx.letterSpacing="-1px",ctx.lineWidth=10,ctx.strokeStyle="black",ctx.strokeText("thoita.com",canvas.w/2,canvas.h/2-140),ctx.fillStyle="white",ctx.fillText("thoita.com",canvas.w/2,canvas.h/2-140);let l=canvas.w/2-ctx.measureText("thoita.com").width/2+ctx.measureText("thoita").width+ctx.measureText(".").width/2;ctx.strokeStyle="black",ctx.strokeText(".",l,canvas.h/2-140),window.clicks>0?ctx.fillStyle=`hsl(${10*window.clicks%360} 100 50)`:ctx.fillStyle="white",ctx.fillText(".",l,canvas.h/2-140),window.clickLoc={x:l,y:canvas.h/2-130},window.activeClicks=window.activeClicks.filter(e=>e.t<=500),ctx.save(),ctx.translate(window.clickLoc.x,window.clickLoc.y);let s=1+window.clicks**.5/10;ctx.scale(s,s);for(let n=0;n<window.activeClicks.length;n++)window.activeClicks[n].t+=e,window.activeClicks[n].x+=window.activeClicks[n].xv*e,window.activeClicks[n].y+=window.activeClicks[n].yv*e,window.activeClicks[n].yv+=.001*e,renderClickCounter({radius:50,timeAlive:window.activeClicks[n].t,totalDamage:window.activeClicks[n].n,x:window.activeClicks[n].x,y:window.activeClicks[n].y});if(ctx.restore(),ctx.letterSpacing="0px",!0===i&&ctx.translate(0,-o),levelBar.draw(),!0===window.connected){const n=menuInventory.topPetalSlots[0].size,a=menuInventory.bottomPetalSlots[0].size,t=n+n*paddingRatio+a+a*paddingRatio-2,r=-canvas.h/2+1.5*t;if(time-window.connectedTime<1e3){const e=easeOutCubic(smoothstep((time-window.connectedTime)/1e3)),n=r*e+(1-e)*t;menuInventory.translateY=n,menuInventory.draw(e)}else!0===window.squadUIEnabled?(menuInventory.translateY=r+.95*squadUI.h,menuInventory.draw(),squadUI.render(e)):(menuInventory.translateY=r,menuInventory.draw());null!==draggingPetalContainer&&draggingPetalContainer.draw()}craftingMenu.drawIcon(),specialGlobalInventory.drawIcon(),globalInventory.drawIcon(),mobGallery.drawIcon(),craftingMenu.draw(),specialGlobalInventory.draw(),globalInventory.draw(),mobGallery.draw(),void 0!==window.characterSelector&&window.characterSelector.draw(),streakMenu.draw()}function renderBg(){if(ctx.fillRect(0,0,canvas.w,canvas.h),!0!==window.noGrid){const e=-time/20%50;ctx.lineWidth=2,ctx.globalAlpha=.6,ctx.beginPath();for(let n=e-ctx.lineWidth;n<=canvas.w+ctx.lineWidth;n+=50)ctx.moveTo(n,0),ctx.lineTo(n,canvas.h);for(let n=-e-ctx.lineWidth;n<=canvas.h+ctx.lineWidth;n+=50)ctx.moveTo(0,n),ctx.lineTo(canvas.w,n);ctx.stroke(),ctx.closePath()}ctx.globalAlpha=1}function easeOutCubic(e){return 1-Math.pow(1-e,3)}function renderAccountMenu(){if(ctx.fillStyle="#1ea761",ctx.fillRect(0,0,canvas.w,canvas.h),!0!==window.noGrid){const e=-time/20%50;ctx.strokeStyle="#1c8c54",ctx.lineWidth=2,ctx.globalAlpha=.6;for(let n=e-ctx.lineWidth;n<=canvas.w+ctx.lineWidth;n+=50)ctx.beginPath(),ctx.moveTo(n,0),ctx.lineTo(n,canvas.h),ctx.stroke(),ctx.closePath();for(let n=-e-ctx.lineWidth;n<=canvas.h+ctx.lineWidth;n+=50)ctx.beginPath(),ctx.moveTo(0,n),ctx.lineTo(canvas.w,n),ctx.stroke(),ctx.closePath()}void 0!==window.loginMessage&&(ctx.fillStyle="white",ctx.strokeStyle="black",ctx.font="900 28px 'Ubuntu'",ctx.textAlign="center",ctx.textBaseline="top",ctx.lineWidth=5,ctx.globalAlpha=1,performance.now()-window.lastLoginMessageChangeTime<500&&(ctx.globalAlpha=(performance.now()-window.lastLoginMessageChangeTime)/500),ctx.strokeText(window.loginMessage,canvas.w/2,canvas.h-40),ctx.fillText(window.loginMessage,canvas.w/2,canvas.h-40),ctx.globalAlpha=1,ctx.textBaseline="middle")}const enemyTypes=Object.keys(enemyRenderMap).filter(e=>"Square"!==e&&"default"!==e&&!1===noRenderingUi.includes(e)),biomeEnemyMap={garden:["Hornet","Bee","Centipede","Evil Centipede","Ant Burrow","Dandelion","DandelionMissile","Ladybug","Rock","Spider","Worker Ant","Baby Ant","Soldier Ant","Dark Ladybug","Queen Ant","Missile","DandelionMissile","Tree","Root"],desert:["Scorpion","Fire Ant Burrow","Beetle","Desert Centipede","Shiny Ladybug","Soldier Fire Ant","Sandstorm","Cactus","Locust","Queen Fire Ant","Desert Moth","Sandstone","Tarantula","Moonlit Frog","Sunlit Frog","ScorpionMissile","Worker Fire Ant","Baby Fire Ant"],ocean:["Bubble","Shell","Jellyfish","Starfish","Leech","Crab","Sponge","Sea Urchin","UrchinMissile","Sea Floor Burrow","Coral","Electric Eel"]},rareBiomeEnemyMap={garden:["Soil"],desert:["FireMissile","Shiny Ant Burrow","Shiny Beetle","Shiny Cactus"],ocean:["Plastic","Ocean Ladybug","Dark Electric Eel","Shiny Electric Eel"]},secretBiomeEnemyMap={desert:["Evil Desert Centipede","Queen Shiny Ant","Soldier Shiny Ant","Ruby Frog","Termite Mound","Queen Termite","Soldier Termite","Worker Termite","Baby Termite","Tick","Whirlpool","Grasshopper","Stickbug","Mushroom"],ocean:["Shiny Plastic","Lilypad","Shiny Lilypad","Carrion Spire","Flowering Lilypad","Poison Dart Frog","Fly","Firefly","Whirlpool","Dark Beetle","Pufferfish","Brisingida","Neuroflare","Swampy Moth","Dauber","Gloomcrawler","Gnat","Gnat Swarm"],garden:["Termite Mound","Queen Termite","Carrion Spire","Soldier Termite","Worker Termite","Baby Termite","Tick","Soldier Shiny Ant","Lilypad","Shiny Lilypad","Flowering Lilypad","Poison Dart Frog","Fly","Firefly","Grasshopper","Stickbug","Swampy Moth","Dauber","Gloomcrawler","Gnat","Gnat Swarm","Mushroom"]};window.enemyStats={};let menuEnemies=[],menuEnemiesInitialized=!1;function initMenuEnemies(){if("undefined"==typeof biomeManager)return;const e=biomeManager.getCurrentBiomeData().current,n=biomeEnemyMap[e]??[],a=window.innerWidth>0?window.innerWidth:canvas.w>0?canvas.w:1920,t=window.innerHeight>0?window.innerHeight:canvas.h>0?canvas.h:1080;for(let e=0;e<20;e++){const e=8.7*Math.sqrt(menuEnemyIncrementRadii[Math.floor(Math.random()*menuEnemyIncrementRadii.length)]*(.1*Math.random()+.95)),r=new Enemy({x:Math.random()*a,y:Math.random()*t,radius:e,hp:100,maxHp:100,id:Math.random(),type:n[Math.floor(Math.random()*n.length)],rarity:0,angle:Math.random()*Math.PI*2,angleVel:.04*Math.random()-.02,xVel:0,yVel:0,sinTimer:200*Math.random(),sinVel:.5*Math.random(),maxSinTimer:200,toRenderUi:!1,isMenuEnemy:!0,wanderAngle:Math.random()*Math.PI*2,wanderSpeed:1+Math.random(),fleeRange:200});menuEnemies.push(r)}menuEnemiesInitialized=!0}let menuEnemyTimer=400;function renderMenuEnemies(){menuEnemiesInitialized||initMenuEnemies();for(let e=0;e<menuEnemies.length;e++){const n=menuEnemies[e],a=mouse.canvasX,t=mouse.canvasY;void 0!==a&&void 0!==t&&(Math.sqrt((a-n.render.x)**2+(t-n.render.y)**2)<2*n.radius+100&&!0!==n.dead?n.isHovered=!0:n.isHovered=!1),n.draw(),n.sinTimer+=dt/16.67,n.angle+=n.angleVel*dt/16.67;let r=0,i=0,o=!1;if(menuPlayer1&&menuPlayer2){const e=n.x-menuPlayer1.baseX,a=n.y-menuPlayer1.baseY,t=Math.sqrt(e*e+a*a),l=n.x-menuPlayer2.baseX,s=n.y-menuPlayer2.baseY,d=Math.sqrt(l*l+s*s);Math.min(t,d)<200&&(o=!0,t<d?(r=e/t*5,i=a/t*5):(r=l/d*5,i=s/d*5))}o||(Math.random()<.02&&(n.wanderAngle=Math.random()*Math.PI*2),r=Math.cos(n.wanderAngle)*n.wanderSpeed,i=Math.sin(n.wanderAngle)*n.wanderSpeed),n.x+=r*dt/16.67,n.y+=i*dt/16.67,n.updateInterpolate();const l=2*n.radius,s=canvas.w||window.innerWidth,d=canvas.h||window.innerHeight;(n.x<-l||n.x>s+l||n.y<-l||n.y>d+l)&&(n.toRemove=!0,spawnMenuEnemyAtBoundary())}menuEnemies=menuEnemies.filter(e=>!0!==e.toRemove),ctx.lastTransform7=ctx.getTransform(),ctx.setTransform(ctx.lastTransform7),delete ctx.lastTransform7}function spawnMenuEnemyAtBoundary(){if("undefined"==typeof biomeManager)return;const e=biomeManager.getCurrentBiomeData().current,n=biomeEnemyMap[e]??[],a=Math.floor(4*Math.random()),t=8.7*Math.sqrt(menuEnemyIncrementRadii[Math.floor(Math.random()*menuEnemyIncrementRadii.length)]*(.1*Math.random()+.95));let r,i;const o=t,l=canvas.w||window.innerWidth,s=canvas.h||window.innerHeight;switch(a){case 0:r=Math.random()*l,i=-o;break;case 1:r=l+o,i=Math.random()*s;break;case 2:r=Math.random()*l,i=s+o;break;case 3:r=-o,i=Math.random()*s}menuEnemies.push(new Enemy({x:r,y:i,radius:t,hp:100,maxHp:100,id:Math.random(),type:n[Math.floor(Math.random()*n.length)],rarity:0,angle:Math.random()*Math.PI*2,angleVel:.04*Math.random()-.02,xVel:0,yVel:0,sinTimer:200*Math.random(),sinVel:.5*Math.random(),maxSinTimer:200,toRenderUi:!1,isMenuEnemy:!0,wanderAngle:Math.random()*Math.PI*2,wanderSpeed:1+Math.random(),fleeRange:200}))}function renderClickCounter({radius:e,timeAlive:n,totalDamage:a,x:t,y:r}){n<500&&0!==a&&(ctx.fillStyle=`hsl(${10*window.clicks%360} 100 50)`,ctx.strokeStyle=`hsl(${10*window.clicks%360} 100 20)`,ctx.lineWidth=7,ctx.font=.4*e<25?"600 25px 'Ubuntu'":.4*e>100?"600 100px 'Ubuntu'":`600 ${.4*e}px 'Ubuntu'`,ctx.textAlign="center",ctx.textBaseline="middle",ctx.globalAlpha=.7*(1-n/500),ctx.strokeText(a,t,r),ctx.fillText(a,t,r),ctx.globalAlpha=1,ctx.letterSpacing="0px")}function renderDebug(){ctx.font="900 15px 'Ubuntu'",ctx.textAlign="right",ctx.textBaseline="bottom",ctx.fillStyle="white",ctx.strokeStyle="black",ctx.lineWidth=2,debugText=`FPS: ${window.fps}`,ctx.strokeText(debugText,canvas.w-2,canvas.h-2),ctx.fillText(debugText,canvas.w-2,canvas.h-2)}function initMenuPlayers(){menuPlayer1=new Flower("menu1"),menuPlayer2=new Flower("menu2"),menuPlayer1.radius=25,menuPlayer2.radius=25,menuPlayer1.maxHp=100,menuPlayer2.maxHp=100,menuPlayer1.hp=100,menuPlayer2.hp=100;const e=(window.innerWidth||canvas.w)/2,n=(window.innerHeight||canvas.h)/2;menuPlayer1.baseX=e-150,menuPlayer1.baseY=n,menuPlayer1.headX=menuPlayer1.baseX,menuPlayer1.headY=menuPlayer1.baseY,menuPlayer2.baseX=e+150,menuPlayer2.baseY=n,menuPlayer2.headX=menuPlayer2.baseX,menuPlayer2.headY=menuPlayer2.baseY,menuPlayer1.angle=0,menuPlayer2.angle=0,menuPlayer1.petalDistance=neutralPetalDistance,menuPlayer2.petalDistance=neutralPetalDistance,menuPlayer1.wanderAngle=Math.random()*Math.PI*2,menuPlayer1.wanderTimer=100*Math.random(),menuPlayer1.wanderPhase=0,menuPlayer2.wanderAngle=Math.random()*Math.PI*2,menuPlayer2.wanderTimer=100*Math.random(),menuPlayer2.wanderPhase=Math.PI,menuPlayer1.render={headX:menuPlayer1.headX,headY:menuPlayer1.headY,radius:menuPlayer1.radius,hp:menuPlayer1.hp,baseX:menuPlayer1.baseX,baseY:menuPlayer1.baseY,isPoisoned:0,healingReduction:1,shield:0,beforeStreakHp:menuPlayer1.hp,fastPetalDistance:neutralPetalDistance,angle:0},menuPlayer2.render={headX:menuPlayer2.headX,headY:menuPlayer2.headY,radius:menuPlayer2.radius,hp:menuPlayer2.hp,baseX:menuPlayer2.baseX,baseY:menuPlayer2.baseY,isPoisoned:0,healingReduction:1,shield:0,beforeStreakHp:menuPlayer2.hp,fastPetalDistance:neutralPetalDistance,angle:0},menuInventory&&menuInventory.topPetalContainers&&menuInventory.bottomPetalContainers&&loadMenuPlayerPetals()}function loadMenuPlayerPetals(){menuPlayer1&&menuPlayer2&&(loadTopPetalsToMenuPlayer(menuPlayer1,menuInventory),loadBottomPetalsToMenuPlayer(menuPlayer2,menuInventory))}function loadTopPetalsToMenuPlayer(e,n){e.petals=[];let a=0;const t=Object.keys(n.topPetalContainers);for(let r of t){const i=n.topPetalContainers[r];if(!i)continue;const o=i.petals[0];if(!o)continue;const l=a/(t.length+1)*Math.PI*2,s=Stats.petals?.[o.type]?.[0],d=new Petal({type:o.type,rarity:o.rarity,id:a++,angleOffset:l,distance:neutralPetalDistance,offset:{distance:0,angle:0},radius:s?.radius||10,amount:i.amount||1,hp:s?.health||100,maxHp:s?.health||100,dead:!1,dying:!1});e.petals.push(d)}}function loadBottomPetalsToMenuPlayer(e,n){e.petals=[];let a=0;const t=Object.keys(n.bottomPetalContainers);for(let r of t){const i=n.bottomPetalContainers[r];if(!i)continue;const o=i.petals[0];if(!o)continue;const l=a/(t.length+1)*Math.PI*2,s=Stats.petals?.[o.type]?.[0],d=new Petal({type:o.type,rarity:o.rarity,id:a++,angleOffset:l,distance:neutralPetalDistance,offset:{distance:0,angle:0},radius:s?.radius||10,amount:i.amount||1,hp:s?.health||100,maxHp:s?.health||100,dead:!1,dying:!1});e.petals.push(d)}}function updateMenuPlayers(e){if(!menuPlayer1||!menuPlayer2)return;const n=e/16.66,a="number"==typeof mouse.canvasX?mouse.canvasX:canvas.w/2,t="number"==typeof mouse.canvasY?mouse.canvasY:canvas.h/2,r=a>=0&&a<=canvas.w&&t>=0&&t<=canvas.h;void 0===updateMenuPlayers.lastMouseX&&(updateMenuPlayers.lastMouseX=a,updateMenuPlayers.lastMouseY=t,updateMenuPlayers.mouseStoppedTime=0),Math.sqrt((a-updateMenuPlayers.lastMouseX)**2+(t-updateMenuPlayers.lastMouseY)**2)<2?updateMenuPlayers.mouseStoppedTime+=e:updateMenuPlayers.mouseStoppedTime=0,updateMenuPlayers.lastMouseX=a,updateMenuPlayers.lastMouseY=t;const i=!r||updateMenuPlayers.mouseStoppedTime>500,o=time/1e3,l=4*n,s=4.5*n,d=50;if(i)for(let e of[menuPlayer1,menuPlayer2]){const a=e===menuPlayer1?l:s;e.wanderAngle+=.15*(Math.random()-.5)*n;let t=e.baseX+Math.cos(e.wanderAngle)*a*.4,r=e.baseY+Math.sin(e.wanderAngle)*a*.4;t<d&&(t=d,e.wanderAngle=Math.random()*Math.PI*2),t>canvas.w-d&&(t=canvas.w-d,e.wanderAngle=Math.random()*Math.PI*2),r<d&&(r=d,e.wanderAngle=Math.random()*Math.PI*2),r>canvas.h-d&&(r=canvas.h-d,e.wanderAngle=Math.random()*Math.PI*2),e.baseX=t,e.baseY=r,e.headX=e.baseX,e.headY=e.baseY}else{const e=8*Math.sin(.8*o+menuPlayer1.wanderPhase),n=8*Math.sin(.7*o+menuPlayer2.wanderPhase),r=t+e,i=a-35-menuPlayer1.baseX,d=r-menuPlayer1.baseY,c=Math.sqrt(i*i+d*d);if(c>5){const e=Math.min(l,.15*c);menuPlayer1.baseX+=i/c*e,menuPlayer1.baseY+=d/c*e}const m=t+n,u=a+35-menuPlayer2.baseX,w=m-menuPlayer2.baseY,h=Math.sqrt(u*u+w*w);if(h>5){const e=Math.min(s,.15*h);menuPlayer2.baseX+=u/h*e,menuPlayer2.baseY+=w/h*e}menuPlayer1.headX=menuPlayer1.baseX,menuPlayer1.headY=menuPlayer1.baseY,menuPlayer2.headX=menuPlayer2.baseX,menuPlayer2.headY=menuPlayer2.baseY}const c=menuPlayer2.baseX-menuPlayer1.baseX,m=menuPlayer2.baseY-menuPlayer1.baseY,u=Math.sqrt(c*c+m*m);if(u<45&&u>0){const e=c/u,n=m/u,a=.1*(45-u);menuPlayer1.baseX-=e*a,menuPlayer1.baseY-=n*a,menuPlayer2.baseX+=e*a,menuPlayer2.baseY+=n*a}const w=a-canvas.w/2,h=t-canvas.h/2;menuPlayer1.angle=Math.atan2(h,w),menuPlayer2.angle=menuPlayer1.angle,menuPlayer1.petalRotation+=menuPlayer1.petalRotateSpeed*n,menuPlayer2.petalRotation+=menuPlayer2.petalRotateSpeed*n}function renderMenuPlayers(){if(!menuPlayer1||!menuPlayer2)return;const e=window.camera;window.camera={x:0,y:0,disableCulling:!0},updateFlowerPosition(menuPlayer1),updateFlowerPosition(menuPlayer2),renderFlowerPetals(menuPlayer1),renderFlowerPetals(menuPlayer2),renderFlowerBody(menuPlayer1),renderFlowerBody(menuPlayer2),window.camera=e}function renderMenuFlower(e){e.x=e.baseX,e.y=e.baseY,e.render.x=e.render.baseX,e.render.y=e.render.baseY,e.render.headX=e.render.headX,e.render.headY=e.render.headY,e.render.baseX=e.baseX,e.render.baseY=e.baseY,e.render.angle=e.angle,e.updateInterpolate();for(let n=0;n<e.petals.length;n++){const a=e.petals[n],t=e.petalRotation+a.angleOffset;a.x=e.baseX+Math.cos(t)*a.distance,a.y=e.baseY+Math.sin(t)*a.distance,a.render.x=a.x,a.render.y=a.y,toRender({x:a.x,y:a.y,radius:a.radius},window.camera)&&a.draw(),a.updateTimer()}toRender({x:e.render.headX,y:e.render.headY,radius:e.render.radius},window.camera)&&e.drawFlower(e.render.headX,e.render.headY,e.render.radius,e.character)}function updateFlowerPosition(e){e.x=e.baseX,e.y=e.baseY,e.render.baseX=e.baseX,e.render.baseY=e.baseY,e.render.headX=e.headX,e.render.headY=e.headY,e.render.angle=e.angle,e.updateInterpolate()}function renderFlowerPetals(e){for(let n=0;n<e.petals.length;n++){const a=e.petals[n],t=e.petalRotation+a.angleOffset;a.x=e.baseX+Math.cos(t)*a.distance,a.y=e.baseY+Math.sin(t)*a.distance,a.render.x=a.x,a.render.y=a.y,toRender({x:a.x,y:a.y,radius:a.radius},window.camera)&&a.draw(),a.updateTimer()}}function renderFlowerBody(e){toRender({x:e.render.headX,y:e.render.headY,radius:e.radius},window.camera)&&e.drawFlower(e.render.headX,e.render.headY,e.render.radius,e.character)}requestAnimationFrame(render);