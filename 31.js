ctx.setFillStyle=e=>{void 0===window.overrideBlendColor?ctx.fillStyle=e:ctx.fillStyle=blendColor(e,window.overrideBlendColor[1],window.overrideBlendColor[0])},ctx.setStrokeStyle=e=>{void 0===window.overrideBlendColor?ctx.strokeStyle=e:ctx.strokeStyle=blendColor(e,window.overrideBlendColor[1],window.overrideBlendColor[0])},ctx.setGlobalAlpha=(e,a=!1)=>{void 0===window.alphaMult||!0===a?ctx.globalAlpha=e:ctx.globalAlpha=window.alphaMult*e},ctx.setFillAlpha=e=>{ctx.fillOpacity=e},ctx.setStrokeAlpha=e=>{ctx.strokeOpacity=e},ctx.setLineWidth=e=>{ctx.lineWidth=e};const editorPetalShapesMap={default:[[]]},editorEnemyShapesMap={default:[[]]};function getCustomPetalTypes(){return Object.keys(editorPetalShapesMap)}function getCustomEnemyTypes(){return Object.keys(editorEnemyShapesMap)}let toResetFadeState;function renderHpBar({x:e,y:a,radius:t,hp:r,maxHp:l,beforeStreakHp:s,givenAlpha:i,flowerName:d,flowerUsername:o,shield:n,team:c},p={fadeState:void 0,fadeTime:0,lastHp:r}){void 0===p.fadeState&&(Math.ceil(p.hp)!==l||n?(p.fadeTime=time,p.fadeState="fadeIn"):(p.fadeState="invisible",p.fadeTime=-220)),void 0===p.lastHp&&(p.lastHp=p.hp),void 0===p.lastShield&&(p.lastShield=p.shield);let h=1;if(!0!==p.dead&&(Math.ceil(p.lastHp)<l&&Math.ceil(p.hp)===l&&0==p.shield?(p.fadeTime=time,p.fadeState="fadeOut"):(Math.ceil(p.lastHp)===l&&Math.ceil(p.hp)<l||0!=p.shield&&0==p.lastShield)&&(p.fadeTime=time,p.fadeState="fadeIn")),p.lastShield=p.shield,p.lastHp=p.hp,toResetFadeState=!1,i&&i>0&&(toResetFadeState=p.fadeState,p.fadeState="visible"),"fadeOut"===p.fadeState)h=1-(time-p.fadeTime)/180,h<0&&(h=0,p.fadeState="invisible");else if("fadeIn"===p.fadeState)h=(time-p.fadeTime)/180,h>1&&(h=1,p.fadeState="visible");else if("invisible"===p.fadeState&&!d)return;!0===p.dead&&(h*=((10-p.deadAnimationTimer)/166)**3),i&&(h=i);const m={w:(t/25)**1.2*25*3.2+.33,h:(t/25)**1.2*25*.39+.33,borderRadius:(t/25)**1.2*25*.25,innerPadding:(t/25)**1.05*1.8-.1};if(ctx.globalAlpha=h,r=Math.max(r,0),s=Math.max(s,0),ctx.fillStyle="#333333",ctx.beginPath(),ctx.roundRect(e-m.w/2,a+1.775*t,m.w,m.h,m.borderRadius),ctx.fill(),ctx.closePath(),void 0!==d&&p.id!==window.selfId&&(ctx.globalAlpha=1,ctx.fillStyle="white",ctx.strokeStyle="black",ctx.lineWidth=2.25,ctx.textAlign="center",ctx.textBaseline="top",ctx.font="900 22px Ubuntu",ctx.strokeText(d,e,a-2.75*t+m.h+2),ctx.fillText(d,e,a-2.75*t+m.h+2),ctx.font="900 10px Ubuntu",ctx.fillStyle="#bbbbbb",ctx.strokeText(o,e,a-2*t+m.h+2),ctx.fillText(o,e,a-2*t+m.h+2)),s<l/10&&(ctx.globalAlpha=Math.max(0,.95*r/(l/10)+.05)*h),s>0){ctx.fillStyle="#dd3434",ctx.beginPath();const r=1.4;ctx.roundRect(e-m.w/2+m.innerPadding*r,a+1.775*t+m.innerPadding*r,(m.w-1.5*m.borderRadius)*Math.min(1,s/l)+1.5*m.borderRadius-2*m.innerPadding*r,m.h-m.innerPadding*r*2,m.borderRadius*m.h/(m.h+2*m.innerPadding)),ctx.fill(),ctx.closePath()}ctx.globalAlpha=h,r<l/10&&(ctx.globalAlpha=Math.max(0,.95*r/(l/10)+.05)*h),r>0&&(ctx.fillStyle="#75dd34","flower"==c&&(ctx.fillStyle="#b5aa31"),ctx.beginPath(),ctx.roundRect(e-m.w/2+m.innerPadding,a+1.775*t+m.innerPadding,(m.w-1.5*m.borderRadius)*Math.min(1,r/l)+1.5*m.borderRadius-2*m.innerPadding,m.h-2*m.innerPadding,m.borderRadius*m.h/(m.h+2*m.innerPadding)),ctx.fill(),ctx.closePath()),n&&n>.005*l&&(ctx.fillStyle="white",ctx.beginPath(),ctx.roundRect(e-m.w/2+m.innerPadding,a+1.805*t+m.innerPadding,(m.w-1.5*m.borderRadius)*Math.min(1,n/l)+1.5*m.borderRadius-2*m.innerPadding,m.h-3*m.innerPadding,m.borderRadius*m.h/(m.h+3*m.innerPadding)),ctx.fill(),ctx.closePath()),ctx.globalAlpha=1,!1!==toResetFadeState&&(p.fadeState=toResetFadeState)}const Colors={rarities:[{name:"Basic",color:"#2ecc71",border:"#27ae60"},{name:"Uncommon",color:"#e91e63",border:"#c11755"},{name:"Scarce",color:"#03a9f4",border:"#0288d1"},{name:"Exceptional",color:"#ff9800",border:"#f57c00"},{name:"Mythical",color:"#ffeb3b",border:"#fbc02d"},{name:"Phantasmal",color:"#b39ddb",border:"#9575cd"},{name:"Ultimate",color:"#f48fb1",border:"#f06292"},{name:"Paramount",color:"#00bcd4",border:"#0097a7"},{name:"Alpha",color:"#424242",border:"#212121"},{name:"Doomed",color:"#c62828",border:"#b71c1c"},{name:"Sacred",color:"#9c27b0",border:"#7b1fa2",fancy:{border:"#7b1fa2",hue:290,light:40,sat:70,spread:30,period:1.5}},{name:"Imperial",color:"#d81b60",border:"#ad1457",fancy:{border:"#ad1457",hue:330,light:45,sat:90,spread:25,period:2,stars:1}},{name:"Absolute",color:"#8e24aa",border:"#6a1b9a",fancy:{border:"#6a1b9a",hue:280,light:40,sat:70,spread:40,period:1.5,stars:2}},{name:"Stellar",color:"#ffc107",border:"#ffa000",fancy:{border:"#ffa000",hue:45,light:55,sat:100,spread:20,period:1.5,stars:2}},{name:"Empyrean",color:"#1565c0",border:"#0d47a1",fancy:{border:"#0d47a1",hue:210,light:45,sat:90,spread:15,period:1,stars:2}},{name:"Seraphic",color:"#bf360c",border:"#870000",fancy:{border:"#870000",hue:12,light:35,sat:85,spread:20,period:1.5,stars:2}},{name:"Ascended",color:"#eceff1",border:"#cfd8dc",fancy:{border:"#cfd8dc",hue:200,light:95,sat:10,spread:30,period:1.5,stars:2}},{name:"Ethereal",color:"#f06292",border:"#e91e63",fancy:{border:"#e91e63",hue:330,light:75,sat:90,spread:30,period:1,stars:2}},{name:"Cosmic",color:"#880e4f",border:"#560027",fancy:{border:"#560027",hue:340,light:30,sat:85,spread:25,period:.75,stars:2}},{name:"Timeless",color:"#00695c",border:"#004d40",fancy:{border:"#004d40",hue:170,light:30,sat:80,spread:35,period:.75,stars:2}},{name:"Godlike",color:"#ff6f00",border:"#e65100",fancy:{border:"#e65100",hue:35,light:50,sat:100,spread:30,period:.75,stars:2}},{name:"Abyssal",color:"#1a237e",border:"#0d134b",fancy:{border:"#0d134b",hue:230,light:25,sat:80,spread:40,period:.75,stars:2}},{name:"Noble",color:"#00838f",border:"#006064",fancy:{border:"#006064",hue:185,light:35,sat:85,spread:35,period:.75,stars:2}},{name:"Entropic",color:"#311b92",border:"#1a0033",fancy:{border:"#1a0033",hue:255,light:18,sat:85,spread:35,period:.5,stars:2}},{name:"Apocalyptic",color:"#b71c1c",border:"#7f0000",fancy:{border:"#7f0000",hue:0,light:35,sat:100,spread:30,period:.75,stars:2}},{name:"Hollow",color:"#5d4037",border:"#3e2723",fancy:{border:"#3e2723",hue:25,light:22,sat:40,spread:30,period:.75,stars:2}},{name:"Overshadowed",color:"#283593",border:"#1a237e",fancy:{border:"#1a237e",hue:235,light:30,sat:70,spread:30,period:.75,stars:2}},{name:"Luminous",color:"#ad1457",border:"#880e4f",fancy:{border:"#880e4f",hue:340,light:35,sat:90,spread:30,period:1,stars:2}},{name:"Banished",color:"#1b5e20",border:"#003300",fancy:{border:"#003300",hue:130,light:18,sat:100,spread:30,period:1,stars:2}},{name:"Iridescent",color:"#7fffd4",border:"#5cdfb4",fancy:{border:"#5cdfb4",hue:160,light:75,sat:100,spread:30,period:.75,stars:2}},{name:"Spectral",color:"#fff59d",border:"#fff176",fancy:{border:"#fff176",hue:55,light:85,sat:90,spread:30,period:.75,stars:2}},{name:"Mystical",color:"#d84315",border:"#a33500",fancy:{border:"#a33500",hue:14,light:45,sat:100,spread:30,period:.75,stars:2}},{name:"Arcane",color:"#558b2f",border:"#3e6421",fancy:{border:"#3e6421",hue:85,light:35,sat:60,spread:30,period:.75,stars:2}},{name:"Occult",color:"#c2185b",border:"#8c0b3e",fancy:{border:"#8c0b3e",hue:340,light:40,sat:85,spread:30,period:.75,stars:2}},{name:"Origin",color:"#e040fb",border:"#aa00ff",fancy:{border:"#aa00ff",hue:300,light:50,sat:100,spread:30,period:2,stars:2}},{name:"Universal",color:"#455a64",border:"#263238"},{name:"Discourse",color:"#795548",border:"#4e342e"},{name:"Triumph",color:"#9ccc65",border:"#7cb342"}],mana:{grace:"#db81da",time:"#2cc6d4",divergence:"#7123b9"},biomes:{garden:{background:"#1ea761",grid:"#1d9157"},desert:{background:"#dece7b",grid:"#a1955a"},ocean:{background:"#547db3",grid:"#41608a"},trench:{background:"#584fa3",grid:"#453e88"},"1v1":{background:"#40444b",grid:"#292b2f"},zoo:{background:"#886d9c",grid:"#665175"},deepzoo:{background:"#6c4887",grid:"#4e3461"},swamp:{background:"#15692d",grid:"#115624"},beach:{background:"#64c0d1",grid:"#529dab"},savanna:{background:"#b19948",grid:"#917d3b"}}};function deepFreeze(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(a=>{const t=e[a];null===t||"object"!=typeof t&&"function"!=typeof t||Object.isFrozen(t)||deepFreeze(t)}),e}function createFancyGradient(e,a){let t=Colors.rarities[a].fancy.hue??0,r=Colors.rarities[a].fancy.sat??100,l=Colors.rarities[a].fancy.light??100,s=Colors.rarities[a].fancy.spread??30,i=Colors.rarities[a].fancy.period??1.5,d=Date.now()/3e3%i-i,o=0,n=(0-d)/(i/4);e.addColorStop(0,`hsl(${linearOscillate(n*Math.PI/2)*s+t}, ${r}%, ${l}%)`);let c=(1-d)/(i/4);for(e.addColorStop(1,`hsl(${linearOscillate(c*Math.PI/2)*s+t}, ${r}%, ${l}%)`);d<1;d+=i/4)d>0&&e.addColorStop(d,`hsl(${linearOscillate(o)*s+t}, ${r}%, ${l}%)`),o+=Math.PI/2}function linearOscillate(e){return(e%=2*Math.PI)<Math.PI?2*e/Math.PI-1:3-2*e/Math.PI}Colors.rarities=deepFreeze(structuredClone(Colors.rarities));let staticGradients={};for(let e=0;e<Colors.rarities.length;e++)if(Colors.rarities[e].fancy)if(e<=23){const a=ctx.createLinearGradient(-30,-30,30,30);createFancyGradient(a,e);const t=ctx.createLinearGradient(-34.875,-34.875,34.875,34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else if(e<=25){const a=ctx.createLinearGradient(30,30,-30,-30);createFancyGradient(a,e);const t=ctx.createLinearGradient(34.875,34.875,-34.875,-34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else if(e<=29){const a=ctx.createRadialGradient(0,0,0,0,0,30);createFancyGradient(a,e);const t=ctx.createRadialGradient(34.875,34.875,0,34.875,34.875,34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else{const a=ctx.createRadialGradient(0,0,30,0,0,0);createFancyGradient(a,e);const t=ctx.createRadialGradient(34.875,34.875,34.875,34.875,34.875,0);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}const editorBaseStats={enemies:{},petals:{default:{radius:10,knockback:.1}},rarities:[{name:"Basic",health:1,damage:1,radius:1,mass:1,petalDamage:1,petalHealth:1,petalHeal:1,petalMass:1,detectionDistance:1,xp:1},{name:"Uncommon",health:2,damage:1.2,radius:1.1,mass:1.52,petalDamage:1.4,petalHealth:1.2,petalHeal:1.51,petalMass:1.52,detectionDistance:1.1,xp:3},{name:"Scarce",health:4,damage:1.5,radius:1.3,mass:2.46,petalDamage:2,petalHealth:1.5,petalHeal:2.23,petalMass:2.46,detectionDistance:1.2,xp:9},{name:"Exceptional",health:8.6,damage:1.9,radius:1.72,mass:5.7,petalDamage:2.9,petalHealth:1.9,petalHeal:3.17,petalMass:5.7,detectionDistance:1.3,xp:27},{name:"Mythical",health:50,damage:2.7,radius:3,mass:18.6,petalDamage:4.8,petalHealth:2.7,petalHeal:4.94,petalMass:18.6,detectionDistance:1.7,xp:81},{name:"Phantasmal",health:110,damage:4.3,radius:5,mass:43,petalDamage:9.7,petalHealth:4.3,petalHeal:10.2,petalMass:43,detectionDistance:2.1,xp:243},{name:"Ultimate",health:310,damage:8.6,radius:7,mass:100,petalDamage:23,petalHealth:8.6,petalHeal:21.45,petalMass:100,detectionDistance:2.5,xp:729},{name:"Paramount",health:1350,damage:17.2,radius:9.5,mass:216,petalDamage:90,petalHealth:17.2,petalHeal:40.3,petalMass:216,detectionDistance:2.5,xp:2187},{name:"Alpha",health:4941,damage:34.4,radius:13,mass:500,petalDamage:315,petalHealth:34.4,petalHeal:74,petalMass:500,detectionDistance:2.5,xp:6561},{name:"Doomed",health:18084,damage:68.8,radius:17.7,mass:1250,petalDamage:1100,petalHealth:68.8,petalHeal:140.6,petalMass:1250,detectionDistance:2.5,xp:4e4},{name:"Sacred",health:66188,damage:137.6,radius:24.1,mass:3125,petalDamage:3850,petalHealth:137.6,petalHeal:267.14,petalMass:3125,detectionDistance:2.5,xp:3e5},{name:"Imperial",health:242247,damage:275.2,radius:33,mass:9375,petalDamage:13475,petalHealth:275.2,petalHeal:507,petalMass:9375,detectionDistance:2.5,xp:3e6},{name:"Absolute",health:968988,damage:550,radius:45,mass:33750,petalDamage:47162.5,petalHealth:550,petalHeal:963,petalMass:33750,detectionDistance:2.5,xp:3e7},{name:"Stellar",health:4844940,damage:1100,radius:62,mass:194400,petalDamage:264115,petalHealth:1650,petalHeal:2889,petalMass:194400,detectionDistance:2.5,xp:5e8},{name:"Empyrean",health:98e5,damage:1650,radius:71,mass:388800,petalDamage:2667561,petalHealth:9900,petalHeal:9625,petalMass:23e5,detectionDistance:2.5,xp:1e10},{name:"Seraphic",health:2e7,damage:2475,radius:81,mass:777600,petalDamage:26945e3,petalHealth:59400,petalHeal:57750,petalMass:276e5,detectionDistance:2.5,xp:3e11},{name:"Ascended",health:6e7,damage:4950,radius:103,mass:23e5,petalDamage:26945e4,petalHealth:267300,petalHeal:21e4,petalMass:384e6,detectionDistance:3.25,xp:9e12},{name:"Ethereal",health:12e7,damage:7425,radius:118,mass:46e5,petalDamage:860973682,petalHealth:422400,petalHeal:191318.76,petalMass:4608e6,detectionDistance:3.25,xp:27e13},{name:"Cosmic",health:36e7,damage:14850,radius:135,mass:138e5,petalDamage:7232178928,petalHealth:1689600,petalHeal:516560.652,petalMass:55296e6,detectionDistance:3.25,xp:81e14},{name:"Timeless",health:72e7,damage:21e3,radius:154,mass:276e5,petalDamage:17113926136,petalHealth:70400,petalHeal:86030,petalMass:48e5,detectionDistance:3.25,xp:243e15},{name:"Godlike",health:144e7,damage:29700,radius:175,mass:552e5,petalDamage:535815e3,petalHealth:140800,petalHeal:16e4,petalMass:96e5,detectionDistance:3.25,xp:7e18},{name:"Abyssal",health:432e7,damage:59400,radius:200,mass:16e7,petalDamage:187e7,petalHealth:281600,petalHeal:32e4,petalMass:192e5,detectionDistance:3.3,xp:2e20},{name:"Noble",health:864e7,damage:89100,radius:228,mass:32e7,petalDamage:36e8,petalHealth:563200,petalHeal:64e4,petalMass:384e6,detectionDistance:3.35,xp:6e21},{name:"Entropic",health:1728e7,damage:133650,radius:258,mass:64e7,petalDamage:72e8,petalHealth:1126400,petalHeal:128e4,petalMass:768e5,detectionDistance:3.4,xp:18e22},{name:"Apocalyptic",health:45e9,damage:267300,radius:295,mass:2e9,petalDamage:144e8,petalHealth:2252800,petalHeal:256e4,petalMass:1536e5,detectionDistance:3.45,xp:6e24},{name:"Hollow",health:11e10,damage:534600,radius:335,mass:6e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:18e25},{name:"Overshadowed",health:22e10,damage:1069200,radius:380,mass:12e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:54e26},{name:"Luminous",health:44e10,damage:1603800,radius:431,mass:24e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:162e27},{name:"Banished",health:114e10,damage:3207600,radius:489,mass:72e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:4.86e30},{name:"Iridescent",health:29e11,damage:6415200,radius:555,mass:144e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:1458e29},{name:"Spectral",health:58e11,damage:9622800,radius:630,mass:288e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:4376e30},{name:"Mystical",health:139e11,damage:19245600,radius:715,mass:864e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:13e34},{name:"Arcane",health:34e12,damage:38491200,radius:811,mass:1788e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:39e35},{name:"Occult",health:68e12,damage:57736800,radius:921,mass:3576e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:117e36},{name:"Origin",health:156e12,damage:115473600,radius:1046,mass:10728e9,petalDamage:1e15,petalHealth:1e12,petalHeal:1e12,petalMass:1e15,detectionDistance:3.5,xp:351e37}]},editorStats={petals:{},enemies:{},rarities:{}};let AmountOfRarities=editorBaseStats.rarities.length;function regenerateEditorStats(){if(editorStats.petals={},editorStats.enemies={},editorStats.rarities={},void 0!==window.petalData_)for(let e in Stats.petals)editorStats.petals[e]=Stats.petals[e];const e=editorBaseStats;for(let a in e.enemies){e.enemies[a],editorStats.enemies[a]={};for(let t=0;t<AmountOfRarities;t++)if(0==t)editorStats.enemies[a][t]=e.enemies[a],null==e.enemies[a].xp&&(editorStats.enemies[a][t].xp=Math.round(e.rarities[t].xp));else{let r={};r=structuredClone(editorStats.enemies[a][t-1]),r.health=Math.round(r.health*e.rarities[t].health/e.rarities[t-1].health*100)/100,r.damage=Math.round(r.damage*e.rarities[t].damage/e.rarities[t-1].damage*100)/100,r.radius=Math.round(r.radius*e.rarities[t].radius/e.rarities[t-1].radius*100)/100,r.xp=Math.round(r.xp*e.rarities[t].xp/e.rarities[t-1].xp*100)/100,r.mass=Math.round(r.mass*e.rarities[t].mass/e.rarities[t-1].mass*100)/100,r.detectionDistance=Math.round(r.detectionDistance*e.rarities[t].detectionDistance/e.rarities[t-1].detectionDistance*100)/100,r.poison&&(r.poison[0]=Math.round(r.poison[0]*e.rarities[t].damage/e.rarities[t-1].damage*100)/100,r.poison[1]=Math.round(r.poison[1]*e.rarities[t].damage/e.rarities[t-1].damage*100)/100);for(let l in editorStats.enemies[a][t-1])null!=e.enemies[a].override&&null!=e.enemies[a].override[t]&&Object.keys(e.enemies[a].override[t]).includes(l)&&(r[l]=e.enemies[a].override[t][l]);editorStats.enemies[a][t]=r}let t=structuredClone(e.enemies[a].drops);for(let e in t){let r=calculateDrops(t[e][0],t[e][1],t[e][2]);for(let t in editorStats.enemies[a])void 0!==r[t]?editorStats.enemies[a][t].drops[e]=r[t]:editorStats.enemies[a][t].drops[e]={}}e.enemies[a].drops=window.structuredClone(t)}for(let a in e.petals){if("default"!=a){let t=e.petals[a];editorStats.petals[a]={};for(let r=0;r<AmountOfRarities;r++)if(0==r){editorStats.petals[a][r]=structuredClone(e.petals.default);for(let e in t)editorStats.petals[a][r][e]=t[e]}else{let l=e.rarities[r].petalDamage/e.rarities[r-1].petalDamage,s=e.rarities[r].petalHealth/e.rarities[r-1].petalHealth,i=e.rarities[r].petalHeal/e.rarities[r-1].petalHeal,d={};for(let e in editorStats.petals[a][r-1]){let o=!1;t.damageScalers.includes(e)?(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*l*100)/100):t.healthScalers.includes(e)?(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*s*100)/100):t.healScalers&&t.healScalers.includes(e)&&(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*i*100)/100),"poison"==e?(d.poison=[],d.poison[0]=Math.round(editorStats.petals[a][r-1].poison[0]*l*100)/100,d.poison[1]=Math.round(editorStats.petals[a][r-1].poison[1]*l*100)/100):o||(d[e]=editorStats.petals[a][r-1][e]),null!=t.override&&null!=t.override[r]&&Object.keys(t.override[r]).includes(e)&&(t.damageScalers.includes(e)||t.healthScalers.includes(e)?d[e]*=t.override[r][e]:d[e]=t.override[r][e])}editorStats.petals[a][r]=d}}if(e.petals[a].slowdown){let t=getSlowdown(structuredClone(e.petals[a].slowdown));for(let e in editorStats.petals[a])editorStats.petals[a][e].slowdown=t[e]}}}function calculateDrops(e,a,t){t||(t=0);const r=[[355e3,71500,1e4,950,150,7,.7,.022,29e-5,2e-6],[542,70,9,1,.27,.1,.0045,.0012,22e-6],[8,1.9,.9,.377,.16,.045,.032,.015,.013,.003,.0013,.001,12e-5,5e-6,2e-6,3e-7]],l=[[0,-2.2,-4.7,-7.9,-10.4,-14.4,-18.9,-24.1,-30.1],[0,-2.5,-5,-7.5,-10,-12.5,-17.5,-20.9,-26,-32,-38,-43,-48,-53,-58],[0,-4,-10.35,-13.5,-15,-16.5,-18,-19.5,-21,-22.5,-24,-25.5,-27,-28.5,-30,-31.5,-33,-34.5,-36,-37.5,-39,-40.5,-42]],s=[[],[],[]];for(let e=0;e<3;e++)for(let a=0;a<l[e].length;a++)0==a?s[e].push(0):s[e].push(1-Math.pow(Math.E,l[e][a]));const i=new Array(35).fill(0).map(()=>new Array(18).fill(0));for(let l=0;l<35;++l){let d=l||0;l>4&&(d=l-1),l>8&&(d=l-2),l>14&&(d=l-3),l>16&&(d=l-4),l>18&&(d=l-2),l>19&&(d=l-3),l>21&&(d=l-4),l>26&&(d=l-5),l>28&&(d=l-6),l>30&&(d=l-7),l>32&&(d=l-8);let o=0,n=0,c=0;l>18?(o=2,n=19,c=12,d-=c):l>9&&(o=1,n=10,c=6,d-=c);for(let p=0;p<=d&&!(p>23);++p){if(p+c<a)continue;let h=s[o][p],m=s[o][p+1];p===d&&(m=1);const f=Math.pow(e*h+(1-e),3e5/r[o][l-n]),u=Math.pow(e*m+(1-e),3e5/r[o][l-n]);l>=t&&(i[l][p+c]=parseFloat((100*(u-f)).toFixed(3)))}}return i}function getSlowdown(e){const a=[9e4,25e3,6450,2162,590,97,16,1.6],t=[0,-1.5,-3.1,-4.7,-7,-9.4,-11.7,-13.7],r=[];for(let e=0;e<t.length;e++)0==e?r.push(0):r.push(1-Math.pow(Math.E,t[e]));const l=new Array(8).fill(0).map(()=>new Array(8).fill(0));for(let t=0;t<8;++t){let s=100;for(let i=0;i<=7&&!(i>7);++i){let d=r[i],o=r[i+1];7===i&&(o=1);const n=Math.pow(e*d+(1-e),3e5/a[t]),c=Math.pow(e*o+(1-e),3e5/a[t]);l[t][i]=Math.max((s*e).toFixed(2),0),s-=100*(c-n)}if(l[t][7]>=0&&t<3){let e=l[t][7];for(let a=0;a<=7;++a)l[t][a]-=e,l[t][a]=Math.max(l[t][a].toFixed(2),0)}}l[8]=[90,90,90,90,90,90,90,90];for(let e of l)e.push(0);return l}Enemy.prototype.changeState=function(e){changeState(this,e)};