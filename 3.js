class CharacterSelector{constructor(){this.characters=[{name:"flower"},{name:"Tanksmith",src:"../gfx/tanksmith.png"}],this.enabled=!0,this.animation=0,this.allImgsLoaded=!1,this.imgsLoaded=0;for(let t=1;t<this.characters.length;t++){const e=this.characters[t];e.img=new Image,e.img.src=e.src,e.img.onload=()=>{this.imgsLoaded++,this.imgsLoaded===this.characters.length-1&&(this.allImgsLoaded=!0)}}this.yMin=-100,this.yMax=55,this.flower=new Flower(0),this.selectedIndex=localStorage.getItem("selectedCharacter")??0,0!==this.selectedIndex&&this.send(),this.renderSelectedIndex=this.selectedIndex,this.lastSentSI=-1}draw(){if(!1===this.allImgsLoaded)return;if(!0===this.enabled)this.animation=interpolate(this.animation,1,.06*dt/16.66);else if(this.animation=interpolate(this.animation,0,.06*dt/16.66),this.animation<.01)return;const t=canvas.w/2-64*(this.characters.length-1)/2,e=canvas.w/2+64*(this.characters.length-1)/2,s=interpolate(this.yMin,this.yMax,this.animation);ctx.translate(0,s),ctx.fillStyle="white",ctx.strokeStyle="black",ctx.font="900 18px Ubuntu",ctx.textBaseline="top",ctx.textAlign="center",ctx.lineWidth=3,ctx.strokeText("Select Character:",canvas.w/2,6-this.yMax),ctx.fillText("Select Character:",canvas.w/2,6-this.yMax),this.renderSelectedIndex=interpolate(this.renderSelectedIndex,this.selectedIndex,.1);const a=interpolate(t,e,this.renderSelectedIndex/(this.characters.length-1));ctx.fillStyle="black",ctx.globalAlpha=.08+.02*Math.sin(time/800),ctx.beginPath(),ctx.roundRect(a-30,-30,60,60,8),ctx.fill(),ctx.closePath(),ctx.globalAlpha=1;for(let a=0;a<this.characters.length;a++){const i=interpolate(t,e,a/(this.characters.length-1));this.characters[a].x=i,this.characters[a].y=s;const h=mouse.x*canvas.w/window.innerWidth,n=mouse.y*canvas.h/window.innerHeight;0!==a?ctx.drawImage(this.characters[a].img,i-30,-30,60,60):(this.flower.render.x=i,this.flower.render.y=s,this.flower.render.angle=interpolateDirection(this.flower.render.angle,Math.atan2(n-s,h-i),.12),this.flower.drawFlower(i,0,24.5))}ctx.translate(0,-s)}onmousedown(t,e){for(let s=0;s<this.characters.length;s++)Math.sqrt((t-this.characters[s].x)**2+(e-this.characters[s].y)**2)<(this.characters[s].radius??25)&&(this.selectedIndex=s,this.send())}send(t=!1){!1===t&&this.lastSentSI===this.selectedIndex||(send({character:this.characters[this.selectedIndex].name}),localStorage.setItem("selectedCharacter",this.selectedIndex),this.lastSentSI=this.selectedIndex,isTs="1"==this.selectedIndex)}}