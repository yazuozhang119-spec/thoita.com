ctx.setFillStyle=e=>{void 0===window.overrideBlendColor?ctx.fillStyle=e:ctx.fillStyle=blendColor(e,window.overrideBlendColor[1],window.overrideBlendColor[0])},ctx.setStrokeStyle=e=>{void 0===window.overrideBlendColor?ctx.strokeStyle=e:ctx.strokeStyle=blendColor(e,window.overrideBlendColor[1],window.overrideBlendColor[0])},ctx.setGlobalAlpha=(e,a=!1)=>{void 0===window.alphaMult||!0===a?ctx.globalAlpha=e:ctx.globalAlpha=window.alphaMult*e},ctx.setFillAlpha=e=>{ctx.fillOpacity=e},ctx.setStrokeAlpha=e=>{ctx.strokeOpacity=e},ctx.setLineWidth=e=>{ctx.lineWidth=e};const editorPetalShapesMap={default:[[]]},editorEnemyShapesMap={default:[[]]};function getCustomPetalTypes(){return Object.keys(editorPetalShapesMap)}function getCustomEnemyTypes(){return Object.keys(editorEnemyShapesMap)}let toResetFadeState;function renderHpBar({x:e,y:a,radius:t,hp:r,maxHp:l,beforeStreakHp:s,givenAlpha:i,flowerName:d,flowerUsername:o,shield:n,team:c},p={fadeState:void 0,fadeTime:0,lastHp:r}){void 0===p.fadeState&&(Math.ceil(p.hp)!==l||n?(p.fadeTime=time,p.fadeState="fadeIn"):(p.fadeState="invisible",p.fadeTime=-220)),void 0===p.lastHp&&(p.lastHp=p.hp),void 0===p.lastShield&&(p.lastShield=p.shield);let h=1;if(!0!==p.dead&&(Math.ceil(p.lastHp)<l&&Math.ceil(p.hp)===l&&0==p.shield?(p.fadeTime=time,p.fadeState="fadeOut"):(Math.ceil(p.lastHp)===l&&Math.ceil(p.hp)<l||0!=p.shield&&0==p.lastShield)&&(p.fadeTime=time,p.fadeState="fadeIn")),p.lastShield=p.shield,p.lastHp=p.hp,toResetFadeState=!1,i&&i>0&&(toResetFadeState=p.fadeState,p.fadeState="visible"),"fadeOut"===p.fadeState)h=1-(time-p.fadeTime)/180,h<0&&(h=0,p.fadeState="invisible");else if("fadeIn"===p.fadeState)h=(time-p.fadeTime)/180,h>1&&(h=1,p.fadeState="visible");else if("invisible"===p.fadeState&&!d)return;!0===p.dead&&(h*=((10-p.deadAnimationTimer)/166)**3),i&&(h=i);const m={w:(t/25)**1.2*25*3.2+.33,h:(t/25)**1.2*25*.39+.33,borderRadius:(t/25)**1.2*25*.25,innerPadding:(t/25)**1.05*1.8-.1};if(ctx.globalAlpha=h,r=Math.max(r,0),s=Math.max(s,0),ctx.fillStyle="#333333",ctx.beginPath(),ctx.roundRect(e-m.w/2,a+1.775*t,m.w,m.h,m.borderRadius),ctx.fill(),ctx.closePath(),void 0!==d&&p.id!==window.selfId&&(ctx.globalAlpha=1,ctx.fillStyle="white",ctx.strokeStyle="black",ctx.lineWidth=2.25,ctx.textAlign="center",ctx.textBaseline="top",ctx.font="900 22px Ubuntu",ctx.strokeText(d,e,a-2.75*t+m.h+2),ctx.fillText(d,e,a-2.75*t+m.h+2),ctx.font="900 10px Ubuntu",ctx.fillStyle="#bbbbbb",ctx.strokeText(o,e,a-2*t+m.h+2),ctx.fillText(o,e,a-2*t+m.h+2)),s<l/10&&(ctx.globalAlpha=Math.max(0,.95*r/(l/10)+.05)*h),s>0){ctx.fillStyle="#dd3434",ctx.beginPath();const r=1.4;ctx.roundRect(e-m.w/2+m.innerPadding*r,a+1.775*t+m.innerPadding*r,(m.w-1.5*m.borderRadius)*Math.min(1,s/l)+1.5*m.borderRadius-2*m.innerPadding*r,m.h-m.innerPadding*r*2,m.borderRadius*m.h/(m.h+2*m.innerPadding)),ctx.fill(),ctx.closePath()}ctx.globalAlpha=h,r<l/10&&(ctx.globalAlpha=Math.max(0,.95*r/(l/10)+.05)*h),r>0&&(ctx.fillStyle="#75dd34","flower"==c&&(ctx.fillStyle="#b5aa31"),ctx.beginPath(),ctx.roundRect(e-m.w/2+m.innerPadding,a+1.775*t+m.innerPadding,(m.w-1.5*m.borderRadius)*Math.min(1,r/l)+1.5*m.borderRadius-2*m.innerPadding,m.h-2*m.innerPadding,m.borderRadius*m.h/(m.h+2*m.innerPadding)),ctx.fill(),ctx.closePath()),n&&n>.005*l&&(ctx.fillStyle="white",ctx.beginPath(),ctx.roundRect(e-m.w/2+m.innerPadding,a+1.805*t+m.innerPadding,(m.w-1.5*m.borderRadius)*Math.min(1,n/l)+1.5*m.borderRadius-2*m.innerPadding,m.h-3*m.innerPadding,m.borderRadius*m.h/(m.h+3*m.innerPadding)),ctx.fill(),ctx.closePath()),ctx.globalAlpha=1,!1!==toResetFadeState&&(p.fadeState=toResetFadeState)}const Colors={rarities:[{name:"Common",color:"#7eef6d",border:"#66c258"},{name:"Unusual",color:"#ffe65d",border:"#cfba4b"},{name:"Rare",color:"#4d52e3",border:"#3e42b8"},{name:"Epic",color:"#861fde",border:"#6d19b4"},{name:"Legendary",color:"#de1f1f",border:"#b41919"},{name:"Mythic",color:"#1fdbde",border:"#19b1b4"},{name:"Ultra",color:"#ff2b75",border:"#cf235f"},{name:"Super",color:"#2bffa3",border:"#23cf84"},{name:"Omega",color:"#494849",border:"#3b3a3b"},{name:"Fabled",color:"#ff5500",border:"#cf4500"},{name:"Divine",color:"#67549c",border:"#53447e",fancy:{border:"#53447e",hue:256,light:47,sat:30,spread:20,period:1.5}},{name:"Supreme",color:"#b25dd9",border:"#904bb0",fancy:{border:"#904bb0",hue:281,light:61,sat:62,spread:12,period:2,stars:1}},{name:"Omnipotent",color:"#5e004f",border:"#000000",fancy:{border:"#151515",hue:285,light:20,sat:100,spread:35,period:1.5,stars:2}},{name:"Astral",color:"#046307",border:"#035005",fancy:{border:"#035005",hue:122,light:25,sat:100,spread:60,period:1.5,stars:2}},{name:"Celestial",color:"#608efc",border:"#4f6bd1",fancy:{border:"#4f6bd1",hue:225,light:69,sat:100,spread:10,period:1,stars:2}},{name:"Seraphic",color:"#c77e5b",border:"#a16649",fancy:{border:"#a16649",hue:19,light:57,sat:49,spread:15,period:1.5,stars:2}},{name:"Transcendent",color:"#ffffff",border:"#cfcfcf",fancy:{border:"#cfcfcf",hue:180,light:93,sat:100,spread:80,period:1.5,stars:2}},{name:"Ethereal",color:"#f6c5de",border:"#d1a3ba",fancy:{border:"#d1a3ba",hue:341,light:89,sat:100,spread:40,period:1,stars:2}},{name:"Galactic",color:"#7f0226",border:"#974d63",fancy:{border:"#974d63",hue:343,light:26,sat:97,spread:20,period:.75,stars:2}},{name:"Eternal",color:"#0cc151",border:"#0b3b1f",fancy:{border:"#0b3b1f",hue:145,light:40,sat:90,spread:30,period:.75,stars:2}},{name:"Apotheotic",color:"#ad831e",border:"#5e4b2c",fancy:{border:"#5e4b2c",hue:55,light:40,sat:70,spread:35,period:.75,stars:2}},{name:"Voidbound",color:"#4b1dad",border:"#3c1263",fancy:{border:"#3c1263",hue:271,light:40,sat:75,spread:35,period:.75,stars:2}},{name:"Exalted",color:"#197f8d",border:"#3c1157",fancy:{border:"#3c1157",hue:203,light:35,sat:72,spread:35,period:.75,stars:2}},{name:"Chaos",color:"#1d0f3e",border:"#161a61",fancy:{border:"#161a61",hue:237,light:15,sat:62,spread:30,period:.5,stars:2}},{name:"Cataclysmic",color:"#c2410a",border:"#630808",fancy:{border:"#630808",hue:30,light:40,sat:90,spread:30,period:.75,stars:2}},{name:"Nullborne",color:"#434246",border:"#666666",fancy:{border:"#666666",hue:313,light:26,sat:15,spread:200,period:.75,stars:2}},{name:"Eclipsed",color:"#6584c7",border:"#2f1d70",fancy:{border:"#2f1d70",hue:221,light:41,sat:33,spread:50,period:.75,stars:2}},{name:"Radiant",color:"#990077",border:"#770060",fancy:{border:"#770060",hue:305,light:35,sat:100,spread:50,period:2,stars:2}},{name:"Forsaken",color:"#006742",border:"#055",fancy:{border:"#055",hue:150,light:20,sat:100,spread:150,period:2,stars:2}},{name:"Chromatic",color:"#a6fffb",border:"#8bd9d5",fancy:{border:"#8bd9d5",hue:177,light:81,sat:100,spread:100,period:.75,stars:2}},{name:"Prismatic",color:"#fff0a6",border:"#c2a92d",fancy:{border:"#c2a92d",hue:50,light:83,sat:100,spread:100,period:.75,stars:2}},{name:"Arcane",color:"#a14b0e",border:"#cc5604",fancy:{border:"#cc5604",hue:25,light:34,sat:84,spread:60,period:.75,stars:2}},{name:"Esoteric",color:"#32947b",border:"#43ba9c",fancy:{border:"#43ba9c",hue:165,light:50,sat:47,spread:90,period:.75,stars:2}},{name:"Metaphysical",color:"#6e3470",border:"#87438a",fancy:{border:"#87438a",hue:298,light:32,sat:37,spread:90,period:.75,stars:2}},{name:"Primordial",color:"#b8e0cc",border:"#000000",fancy:{border:"#000000",hue:149,light:80,sat:40,spread:720,period:4,stars:3}},{name:"General",color:"#123456",border:"#234567"},{name:"Florr-discussion",color:"#593849",border:"#192385"},{name:"Square Victory!",color:"#958349",border:"#129348"}],mana:{grace:"#db81da",time:"#2cc6d4",divergence:"#7123b9"},biomes:{garden:{background:"#1ea761",grid:"#1d9157"},desert:{background:"#dece7b",grid:"#a1955a"},ocean:{background:"#547db3",grid:"#41608a"},trench:{background:"#584fa3",grid:"#453e88"},"1v1":{background:"#40444b",grid:"#292b2f"},zoo:{background:"#886d9c",grid:"#665175"},deepzoo:{background:"#6c4887",grid:"#4e3461"},swamp:{background:"#15692d",grid:"#115624"},beach:{background:"#64c0d1",grid:"#529dab"},savanna:{background:"#b19948",grid:"#917d3b"}}};function deepFreeze(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(a=>{const t=e[a];null===t||"object"!=typeof t&&"function"!=typeof t||Object.isFrozen(t)||deepFreeze(t)}),e}function createFancyGradient(e,a){let t=Colors.rarities[a].fancy.hue??0,r=Colors.rarities[a].fancy.sat??100,l=Colors.rarities[a].fancy.light??100,s=Colors.rarities[a].fancy.spread??30,i=Colors.rarities[a].fancy.period??1.5,d=Date.now()/3e3%i-i,o=0,n=(0-d)/(i/4);e.addColorStop(0,`hsl(${linearOscillate(n*Math.PI/2)*s+t}, ${r}%, ${l}%)`);let c=(1-d)/(i/4);for(e.addColorStop(1,`hsl(${linearOscillate(c*Math.PI/2)*s+t}, ${r}%, ${l}%)`);d<1;d+=i/4)d>0&&e.addColorStop(d,`hsl(${linearOscillate(o)*s+t}, ${r}%, ${l}%)`),o+=Math.PI/2}function linearOscillate(e){return(e%=2*Math.PI)<Math.PI?2*e/Math.PI-1:3-2*e/Math.PI}Colors.rarities=deepFreeze(structuredClone(Colors.rarities));let staticGradients={};for(let e=0;e<Colors.rarities.length;e++)if(Colors.rarities[e].fancy)if(e<=23){const a=ctx.createLinearGradient(-30,-30,30,30);createFancyGradient(a,e);const t=ctx.createLinearGradient(-34.875,-34.875,34.875,34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else if(e<=25){const a=ctx.createLinearGradient(30,30,-30,-30);createFancyGradient(a,e);const t=ctx.createLinearGradient(34.875,34.875,-34.875,-34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else if(e<=29){const a=ctx.createRadialGradient(0,0,0,0,0,30);createFancyGradient(a,e);const t=ctx.createRadialGradient(34.875,34.875,0,34.875,34.875,34.875);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}else{const a=ctx.createRadialGradient(0,0,30,0,0,0);createFancyGradient(a,e);const t=ctx.createRadialGradient(34.875,34.875,34.875,34.875,34.875,0);createFancyGradient(t,e),staticGradients[e]=a,staticGradients[e+"_"]=t}const editorBaseStats={enemies:{},petals:{default:{radius:10,knockback:.1}},rarities:[{name:"Common",health:1,damage:1,radius:1,mass:1,petalDamage:1,petalHealth:1,petalHeal:1,petalMass:1,detectionDistance:1,xp:1},{name:"Unusual",health:2,damage:1.2,radius:1.1,mass:1.52,petalDamage:1.4,petalHealth:1.2,petalHeal:1.51,petalMass:1.52,detectionDistance:1.1,xp:3},{name:"Rare",health:4,damage:1.5,radius:1.3,mass:2.46,petalDamage:2,petalHealth:1.5,petalHeal:2.23,petalMass:2.46,detectionDistance:1.2,xp:9},{name:"Epic",health:8.6,damage:1.9,radius:1.72,mass:5.7,petalDamage:2.9,petalHealth:1.9,petalHeal:3.17,petalMass:5.7,detectionDistance:1.3,xp:27},{name:"Legendary",health:50,damage:2.7,radius:3,mass:18.6,petalDamage:4.8,petalHealth:2.7,petalHeal:4.94,petalMass:18.6,detectionDistance:1.7,xp:81},{name:"Mythic",health:110,damage:4.3,radius:5,mass:43,petalDamage:9.7,petalHealth:4.3,petalHeal:10.2,petalMass:43,detectionDistance:2.1,xp:243},{name:"Ultra",health:310,damage:8.6,radius:7,mass:100,petalDamage:23,petalHealth:8.6,petalHeal:21.45,petalMass:100,detectionDistance:2.5,xp:729},{name:"Super",health:1350,damage:17.2,radius:9.5,mass:216,petalDamage:90,petalHealth:17.2,petalHeal:40.3,petalMass:216,detectionDistance:2.5,xp:2187},{name:"Omega",health:4941,damage:34.4,radius:13,mass:500,petalDamage:315,petalHealth:34.4,petalHeal:74,petalMass:500,detectionDistance:2.5,xp:6561},{name:"Fabled",health:18084,damage:68.8,radius:17.7,mass:1250,petalDamage:1100,petalHealth:68.8,petalHeal:140.6,petalMass:1250,detectionDistance:2.5,xp:4e4},{name:"Divine",health:66188,damage:137.6,radius:24.1,mass:3125,petalDamage:3850,petalHealth:137.6,petalHeal:267.14,petalMass:3125,detectionDistance:2.5,xp:3e5},{name:"Supreme",health:242247,damage:275.2,radius:33,mass:9375,petalDamage:13475,petalHealth:275.2,petalHeal:507,petalMass:9375,detectionDistance:2.5,xp:3e6},{name:"Omnipotent",health:968988,damage:550,radius:45,mass:33750,petalDamage:47162.5,petalHealth:550,petalHeal:963,petalMass:33750,detectionDistance:2.5,xp:3e7},{name:"Astral",health:4844940,damage:1100,radius:62,mass:194400,petalDamage:264115,petalHealth:1650,petalHeal:2889,petalMass:194400,detectionDistance:2.5,xp:5e8},{name:"Celestial",health:98e5,damage:1650,radius:71,mass:388800,petalDamage:2667561,petalHealth:9900,petalHeal:9625,petalMass:23e5,detectionDistance:2.5,xp:1e10},{name:"Seraphic",health:2e7,damage:2475,radius:81,mass:777600,petalDamage:26945e3,petalHealth:59400,petalHeal:57750,petalMass:276e5,detectionDistance:2.5,xp:3e11},{name:"Transcendent",health:6e7,damage:4950,radius:103,mass:23e5,petalDamage:26945e4,petalHealth:267300,petalHeal:21e4,petalMass:384e6,detectionDistance:3.25,xp:9e12},{name:"Ethereal",health:12e7,damage:7425,radius:118,mass:46e5,petalDamage:860973682,petalHealth:422400,petalHeal:191318.76,petalMass:4608e6,detectionDistance:3.25,xp:27e13},{name:"Galactic",health:36e7,damage:14850,radius:135,mass:138e5,petalDamage:7232178928,petalHealth:1689600,petalHeal:516560.652,petalMass:55296e6,detectionDistance:3.25,xp:81e14},{name:"Eternal",health:72e7,damage:21e3,radius:154,mass:276e5,petalDamage:17113926136,petalHealth:70400,petalHeal:86030,petalMass:48e5,detectionDistance:3.25,xp:243e15},{name:"Apotheotic",health:144e7,damage:29700,radius:175,mass:552e5,petalDamage:535815e3,petalHealth:140800,petalHeal:16e4,petalMass:96e5,detectionDistance:3.25,xp:7e18},{name:"Voidbound",health:432e7,damage:59400,radius:200,mass:16e7,petalDamage:187e7,petalHealth:281600,petalHeal:32e4,petalMass:192e5,detectionDistance:3.3,xp:2e20},{name:"Exalted",health:864e7,damage:89100,radius:228,mass:32e7,petalDamage:36e8,petalHealth:563200,petalHeal:64e4,petalMass:384e6,detectionDistance:3.35,xp:6e21},{name:"Chaos",health:1728e7,damage:133650,radius:258,mass:64e7,petalDamage:72e8,petalHealth:1126400,petalHeal:128e4,petalMass:768e5,detectionDistance:3.4,xp:18e22},{name:"Cataclysmic",health:45e9,damage:267300,radius:295,mass:2e9,petalDamage:144e8,petalHealth:2252800,petalHeal:256e4,petalMass:1536e5,detectionDistance:3.45,xp:6e24},{name:"Nullborne",health:11e10,damage:534600,radius:335,mass:6e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:18e25},{name:"Eclipsed",health:22e10,damage:1069200,radius:380,mass:12e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:54e26},{name:"Radiant",health:44e10,damage:1603800,radius:431,mass:24e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:162e27},{name:"Forsaken",health:114e10,damage:3207600,radius:489,mass:72e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:4.86e30},{name:"Chromatic",health:29e11,damage:6415200,radius:555,mass:144e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:1458e29},{name:"Prismatic",health:58e11,damage:9622800,radius:630,mass:288e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:4376e30},{name:"Arcane",health:139e11,damage:19245600,radius:715,mass:864e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:13e34},{name:"Esoteric",health:34e12,damage:38491200,radius:811,mass:1788e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:39e35},{name:"Metaphysical",health:68e12,damage:57736800,radius:921,mass:3576e9,petalDamage:288e8,petalHealth:4505600,petalHeal:512e4,petalMass:46e7,detectionDistance:3.5,xp:117e36},{name:"Primordial",health:156e12,damage:115473600,radius:1046,mass:10728e9,petalDamage:1e15,petalHealth:1e12,petalHeal:1e12,petalMass:1e15,detectionDistance:3.5,xp:351e37}]},editorStats={petals:{},enemies:{},rarities:{}};let AmountOfRarities=editorBaseStats.rarities.length;function regenerateEditorStats(){if(editorStats.petals={},editorStats.enemies={},editorStats.rarities={},void 0!==window.petalData_)for(let e in Stats.petals)editorStats.petals[e]=Stats.petals[e];const e=editorBaseStats;for(let a in e.enemies){e.enemies[a];editorStats.enemies[a]={};for(let t=0;t<AmountOfRarities;t++)if(0==t)editorStats.enemies[a][t]=e.enemies[a],null==e.enemies[a].xp&&(editorStats.enemies[a][t].xp=Math.round(e.rarities[t].xp));else{let r={};r=structuredClone(editorStats.enemies[a][t-1]),r.health=Math.round(r.health*e.rarities[t].health/e.rarities[t-1].health*100)/100,r.damage=Math.round(r.damage*e.rarities[t].damage/e.rarities[t-1].damage*100)/100,r.radius=Math.round(r.radius*e.rarities[t].radius/e.rarities[t-1].radius*100)/100,r.xp=Math.round(r.xp*e.rarities[t].xp/e.rarities[t-1].xp*100)/100,r.mass=Math.round(r.mass*e.rarities[t].mass/e.rarities[t-1].mass*100)/100,r.detectionDistance=Math.round(r.detectionDistance*e.rarities[t].detectionDistance/e.rarities[t-1].detectionDistance*100)/100,r.poison&&(r.poison[0]=Math.round(r.poison[0]*e.rarities[t].damage/e.rarities[t-1].damage*100)/100,r.poison[1]=Math.round(r.poison[1]*e.rarities[t].damage/e.rarities[t-1].damage*100)/100);for(let l in editorStats.enemies[a][t-1])null!=e.enemies[a].override&&null!=e.enemies[a].override[t]&&Object.keys(e.enemies[a].override[t]).includes(l)&&(r[l]=e.enemies[a].override[t][l]);editorStats.enemies[a][t]=r}let t=structuredClone(e.enemies[a].drops);for(let e in t){let r=calculateDrops(t[e][0],t[e][1],t[e][2]);for(let t in editorStats.enemies[a])void 0!==r[t]?editorStats.enemies[a][t].drops[e]=r[t]:editorStats.enemies[a][t].drops[e]={}}e.enemies[a].drops=window.structuredClone(t)}for(let a in e.petals){if("default"!=a){let t=e.petals[a];editorStats.petals[a]={};for(let r=0;r<AmountOfRarities;r++)if(0==r){editorStats.petals[a][r]=structuredClone(e.petals.default);for(let e in t)editorStats.petals[a][r][e]=t[e]}else{let l=e.rarities[r].petalDamage/e.rarities[r-1].petalDamage,s=e.rarities[r].petalHealth/e.rarities[r-1].petalHealth,i=e.rarities[r].petalHeal/e.rarities[r-1].petalHeal,d={};for(let e in editorStats.petals[a][r-1]){let o=!1;t.damageScalers.includes(e)?(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*l*100)/100):t.healthScalers.includes(e)?(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*s*100)/100):t.healScalers&&t.healScalers.includes(e)&&(o=!0,d[e]=Math.round(editorStats.petals[a][r-1][e]*i*100)/100),"poison"==e?(d.poison=[],d.poison[0]=Math.round(editorStats.petals[a][r-1].poison[0]*l*100)/100,d.poison[1]=Math.round(editorStats.petals[a][r-1].poison[1]*l*100)/100):o||(d[e]=editorStats.petals[a][r-1][e]),null!=t.override&&null!=t.override[r]&&Object.keys(t.override[r]).includes(e)&&(t.damageScalers.includes(e)||t.healthScalers.includes(e)?d[e]*=t.override[r][e]:d[e]=t.override[r][e])}editorStats.petals[a][r]=d}}if(e.petals[a].slowdown){let t=getSlowdown(structuredClone(e.petals[a].slowdown));for(let e in editorStats.petals[a])editorStats.petals[a][e].slowdown=t[e]}}}function calculateDrops(e,a,t){t||(t=0);const r=[[355e3,71500,1e4,950,150,7,.7,.022,29e-5,2e-6],[542,70,9,1,.27,.1,.0045,.0012,22e-6],[8,1.9,.9,.377,.16,.045,.032,.015,.013,.003,.0013,.001,12e-5,5e-6,2e-6,3e-7]],l=[[0,-2.2,-4.7,-7.9,-10.4,-14.4,-18.9,-24.1,-30.1],[0,-2.5,-5,-7.5,-10,-12.5,-17.5,-20.9,-26,-32,-38,-43,-48,-53,-58],[0,-4,-10.35,-13.5,-15,-16.5,-18,-19.5,-21,-22.5,-24,-25.5,-27,-28.5,-30,-31.5,-33,-34.5,-36,-37.5,-39,-40.5,-42]],s=[[],[],[]];for(let e=0;e<3;e++)for(let a=0;a<l[e].length;a++)0==a?s[e].push(0):s[e].push(1-Math.pow(Math.E,l[e][a]));const i=new Array(35).fill(0).map(e=>new Array(18).fill(0));for(let l=0;l<35;++l){let d=l||0;l>4&&(d=l-1),l>8&&(d=l-2),l>14&&(d=l-3),l>16&&(d=l-4),l>18&&(d=l-2),l>19&&(d=l-3),l>21&&(d=l-4),l>26&&(d=l-5),l>28&&(d=l-6),l>30&&(d=l-7),l>32&&(d=l-8);let o=0,n=0,c=0;l>18?(o=2,n=19,c=12,d-=c):l>9&&(o=1,n=10,c=6,d-=c);for(let p=0;p<=d&&!(p>23);++p){if(p+c<a)continue;let h=s[o][p],m=s[o][p+1];p===d&&(m=1);const f=Math.pow(e*h+(1-e),3e5/r[o][l-n]),u=Math.pow(e*m+(1-e),3e5/r[o][l-n]);l>=t&&(i[l][p+c]=parseFloat((100*(u-f)).toFixed(3)))}}return i}function getSlowdown(e){const a=[9e4,25e3,6450,2162,590,97,16,1.6],t=[0,-1.5,-3.1,-4.7,-7,-9.4,-11.7,-13.7],r=[];for(let e=0;e<t.length;e++)0==e?r.push(0):r.push(1-Math.pow(Math.E,t[e]));const l=new Array(8).fill(0).map(e=>new Array(8).fill(0));for(let t=0;t<8;++t){let s=100;for(let i=0;i<=7&&!(i>7);++i){let d=r[i],o=r[i+1];7===i&&(o=1);const n=Math.pow(e*d+(1-e),3e5/a[t]),c=Math.pow(e*o+(1-e),3e5/a[t]);l[t][i]=Math.max((s*e).toFixed(2),0),s-=100*(c-n)}if(l[t][7]>=0&&t<3){let e=l[t][7];for(let a=0;a<=7;++a)l[t][a]-=e,l[t][a]=Math.max(l[t][a].toFixed(2),0)}}l[8]=[90,90,90,90,90,90,90,90];for(let e of l)e.push(0);return l}Enemy.prototype.changeState=function(e){changeState(this,e)};