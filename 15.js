const noEnemyBox=[];class enemyBox{constructor(e,t,s,i,n,o,r,y){this.enemy=new Enemy({...e,radius:182}),this.enemy.toRenderUi=!1,this.enemy.isInEnemyBox=!0,this.enemy.render.radius=0,this.enemy.angle=-Math.PI/4,this.x=i,this.y=n,this.w=0,this.h=0,this.type=s,this.rarity=Number(t),this.targetW=o,this.targetH=r,this.targetX=i,this.targetY=n,this.amount=1,this.deleteTimer=0,this.delete=!1,this.isBoss=y}update(){this.toDelete?(this.deleteTimer-=dt,this.deleteTimer<0&&(this.delete=!0)):this.deleteTimer=200,dt<100?(this.x+=(this.targetX-this.x)*dt/100,this.y+=(this.targetY-this.y)*dt/100,this.w+=(this.targetW-this.w)*dt/100,this.h+=(this.targetH-this.h)*dt/100):(this.x=this.targetX,this.y=this.targetY,this.w=this.targetW,this.h=this.targetH)}}function createEnemyBox(e,t){if(void 0!==e.ownerId)return;let s=!1,i=!1;e.isBoss&&(e.rarity+=125);for(let n of t.enemyBoxes)if(!n.delete&&n.type==e.type&&(s=!0,n.rarity==e.rarity)){i=!0,n.amount++,n.lastAmountChangedTime=time,1==n.toDelete&&(n.toDelete=!1,n.delete=!1,n.targetW=enemyBoxSize,n.targetH=enemyBoxSize);break}if(0==s){let s=[];for(let e=0;e<t.enemyBoxes.length;e++){let i=t.enemyBoxes[e];s.includes(i.type)||s.push(i.type),i.targetX-=enemyBoxBoundSize/2}t.enemyBoxes.push(new enemyBox(e,Number(e.rarity),e.customType??e.type,enemyBoxBaseX+s.length*enemyBoxBoundSize/2,enemyBoxBaseY,enemyBoxSize,enemyBoxSize,e.isBoss))}else if(0==i){let s=enemyBoxBaseY,i=0;for(let n=0;n<t.enemyBoxes.length;n++){let o=t.enemyBoxes[n];o.type==e.type&&(i=o.targetX,Number(o.rarity)<Number(e.rarity)?s+=enemyBoxOverlapSize:o.targetY+=enemyBoxOverlapSize)}t.enemyBoxes.push(new enemyBox(e,Number(e.rarity),e.customType??e.type,i,s,enemyBoxSize,enemyBoxSize,e.isBoss)),t.enemyBoxes.sort(function(e,t){return Number(e.rarity)-Number(t.rarity)})}alignEnemyBoxes()}function alignEnemyBoxes(e=null){let t=[],s={};for(let i=0;i<room.enemyBoxes.length;i++){let n=room.enemyBoxes[i];n!==e&&(void 0===s[n.type]?(s[n.type]=[n],t.push(n.type)):s[n.type].push(n))}let i=enemyBoxBaseX-enemyBoxBoundSize*(Object.keys(s).length-1)/2;for(let n=0;n<t.length;n++){const o=t[n];for(let t=0;t<s[o].length;t++){const n=s[o][t];n!==e&&(n.targetX=i)}i+=enemyBoxBoundSize}}